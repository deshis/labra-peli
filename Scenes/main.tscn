[gd_scene load_steps=15 format=3 uid="uid://chpqcweaiakc5"]

[ext_resource type="Script" path="res://Scripts/main.gd" id="1_cx8ll"]
[ext_resource type="Script" path="res://Scripts/WorldEnvironment.gd" id="2_7q2bx"]
[ext_resource type="PackedScene" uid="uid://tr2nbcbcmnu2" path="res://Scenes/Player.tscn" id="2_d6f1p"]
[ext_resource type="Script" path="res://Scripts/DirectionalLight3D.gd" id="2_xe4gy"]
[ext_resource type="PackedScene" uid="uid://b267c0jqhpirv" path="res://Scenes/mental_asylum.tscn" id="4_b3svt"]
[ext_resource type="PackedScene" uid="uid://ekyt2ivgmsmy" path="res://Assets/monkey.glb" id="4_y0b6v"]
[ext_resource type="Script" path="res://Scripts/healthbar.gd" id="5_fvphu"]
[ext_resource type="Texture2D" uid="uid://b8ppk454bulgt" path="res://Sprites/UI/Bar/empty.png" id="5_lrdkv"]
[ext_resource type="PackedScene" uid="uid://dfbfxm4ytxuls" path="res://Scenes/enemy.tscn" id="5_rk86j"]
[ext_resource type="Texture2D" uid="uid://doceu5pqyb70l" path="res://Sprites/UI/Bar/full.png" id="6_dnqkv"]
[ext_resource type="Script" path="res://Scripts/Menu/PauseMenu.gd" id="9_5iedf"]
[ext_resource type="Script" path="res://Scripts/Menu/Button.gd" id="10_uq3l4"]

[sub_resource type="Environment" id="Environment_p801p"]
ambient_light_color = Color(1, 1, 1, 1)
ambient_light_energy = 0.05
ssao_radius = 3.0
ssao_intensity = 5.0
ssil_radius = 12.2
ssil_intensity = 16.0
sdfgi_read_sky_light = false
sdfgi_bounce_feedback = 0.0
fog_light_color = Color(0.662745, 0.47451, 0.666667, 1)
adjustment_brightness = 0.41
adjustment_contrast = 2.66

[sub_resource type="NavigationMesh" id="NavigationMesh_7y7p8"]
vertices = PackedVector3Array(-5.3943, 36.3372, 14.262, -6.8943, 36.3372, 14.262, -6.8943, 36.3372, 15.762, -6.8943, 36.3372, 26.262, -6.8943, 36.3372, 28.012, -5.3943, 36.3372, 28.012, 6.8557, 36.3372, 15.762, 6.8557, 36.3372, 14.262, 5.1057, 36.3372, 14.262, 5.1057, 36.3372, 28.012, 6.8557, 36.3372, 28.012, 6.8557, 36.3372, 26.262, -3.6443, 36.3372, 14.262, -5.3943, 36.3372, 14.262, -6.8943, 36.3372, 15.762, -6.8943, 36.3372, 17.512, -6.8943, 36.3372, 26.262, -5.3943, 36.3372, 28.012, -3.6443, 36.3372, 28.012, 6.8557, 36.3372, 17.512, 6.8557, 36.3372, 15.762, 5.1057, 36.3372, 14.262, 3.3557, 36.3372, 14.262, 3.3557, 36.3372, 28.012, 5.1057, 36.3372, 28.012, 6.8557, 36.3372, 26.262, -6.8943, 36.3372, 22.762, -6.8943, 36.3372, 24.512, -1.8943, 36.3372, 28.012, -0.1443, 36.3372, 28.012, -6.8943, 36.3372, 24.512, -6.8943, 36.3372, 26.262, -3.6443, 36.3372, 28.012, -1.8943, 36.3372, 28.012, 6.8557, 36.3372, 21.012, 6.8557, 36.3372, 19.262, 1.6057, 36.3372, 14.262, -0.1443, 36.3372, 14.262, 3.3557, 36.3372, 28.012, 6.8557, 36.3372, 26.262, 6.8557, 36.3372, 24.512, 1.6057, 36.3372, 28.012, -1.8943, 36.3372, 14.262, -3.6443, 36.3372, 14.262, -6.8943, 36.3372, 17.512, -6.8943, 36.3372, 19.262, 1.6057, 36.3372, 28.012, 6.8557, 36.3372, 24.512, 6.8557, 36.3372, 22.762, -0.1443, 36.3372, 28.012, 6.8557, 36.3372, 19.262, 6.8557, 36.3372, 17.512, 3.3557, 36.3372, 14.262, 1.6057, 36.3372, 14.262, -0.1443, 36.3372, 14.262, -1.8943, 36.3372, 14.262, -6.8943, 36.3372, 19.262, -6.8943, 36.3372, 21.012, -6.8943, 36.3372, 21.012, -6.8943, 36.3372, 22.762, -0.1443, 36.3372, 28.012, 6.8557, 36.3372, 22.762, 6.8557, 36.3372, 21.012, -0.1443, 36.3372, 14.262, -5.1443, 26.0872, 14.512, -6.6443, 26.0872, 14.512, -6.6443, 26.0872, 16.012, -6.6443, 26.0872, 26.012, -6.6443, 26.0872, 27.762, -5.1443, 26.0872, 27.762, 6.6057, 26.0872, 16.012, 6.6057, 26.0872, 14.512, 4.8557, 26.0872, 14.512, 4.8557, 26.0872, 27.762, 6.6057, 26.0872, 27.762, 6.6057, 26.0872, 26.012, -3.3943, 26.0872, 14.512, -5.1443, 26.0872, 14.512, -6.6443, 26.0872, 16.012, -6.6443, 26.0872, 17.762, -6.6443, 26.0872, 26.012, -5.1443, 26.0872, 27.762, -3.3943, 26.0872, 27.762, -6.6443, 26.0872, 24.262, 6.6057, 26.0872, 17.762, 6.6057, 26.0872, 16.012, 4.8557, 26.0872, 14.512, 3.1057, 26.0872, 14.512, 3.1057, 26.0872, 27.762, 4.8557, 26.0872, 27.762, 6.6057, 26.0872, 26.012, -6.6443, 26.0872, 21.012, -1.8943, 26.0872, 27.762, -0.1443, 26.0872, 27.762, 6.6057, 26.0872, 22.512, 6.6057, 26.0872, 21.012, -0.1443, 26.0872, 14.512, 1.3557, 26.0872, 27.762, 6.6057, 26.0872, 24.262, 6.6057, 26.0872, 22.512, -0.1443, 26.0872, 27.762, 6.6057, 26.0872, 19.262, 1.3557, 26.0872, 14.512, -0.1443, 26.0872, 14.512, 6.6057, 26.0872, 21.012, 3.1057, 26.0872, 27.762, 6.6057, 26.0872, 26.012, 6.6057, 26.0872, 24.262, 1.3557, 26.0872, 27.762, -1.8943, 26.0872, 14.512, -3.3943, 26.0872, 14.512, -6.6443, 26.0872, 17.762, -6.6443, 26.0872, 19.262, -6.6443, 26.0872, 24.262, -3.3943, 26.0872, 27.762, -1.8943, 26.0872, 27.762, -6.6443, 26.0872, 22.512, 6.6057, 26.0872, 19.262, 6.6057, 26.0872, 17.762, 3.1057, 26.0872, 14.512, 1.3557, 26.0872, 14.512, -0.1443, 26.0872, 14.512, -1.8943, 26.0872, 14.512, -6.6443, 26.0872, 19.262, -6.6443, 26.0872, 21.012, -6.6443, 26.0872, 21.012, -6.6443, 26.0872, 22.512, -1.8943, 26.0872, 27.762)
polygons = [PackedInt32Array(2, 1, 0), PackedInt32Array(5, 4, 3), PackedInt32Array(8, 7, 6), PackedInt32Array(11, 10, 9), PackedInt32Array(13, 12, 14), PackedInt32Array(14, 12, 15), PackedInt32Array(18, 17, 16), PackedInt32Array(20, 19, 21), PackedInt32Array(21, 19, 22), PackedInt32Array(25, 24, 23), PackedInt32Array(27, 26, 28), PackedInt32Array(28, 26, 29), PackedInt32Array(31, 30, 32), PackedInt32Array(32, 30, 33), PackedInt32Array(35, 34, 36), PackedInt32Array(36, 34, 37), PackedInt32Array(39, 38, 40), PackedInt32Array(40, 38, 41), PackedInt32Array(43, 42, 44), PackedInt32Array(44, 42, 45), PackedInt32Array(47, 46, 48), PackedInt32Array(48, 46, 49), PackedInt32Array(51, 50, 52), PackedInt32Array(52, 50, 53), PackedInt32Array(55, 54, 56), PackedInt32Array(56, 54, 57), PackedInt32Array(59, 58, 60), PackedInt32Array(60, 58, 61), PackedInt32Array(61, 58, 62), PackedInt32Array(62, 58, 63), PackedInt32Array(66, 65, 64), PackedInt32Array(69, 68, 67), PackedInt32Array(72, 71, 70), PackedInt32Array(75, 74, 73), PackedInt32Array(77, 76, 78), PackedInt32Array(78, 76, 79), PackedInt32Array(81, 80, 82), PackedInt32Array(82, 80, 83), PackedInt32Array(85, 84, 86), PackedInt32Array(86, 84, 87), PackedInt32Array(90, 89, 88), PackedInt32Array(92, 91, 93), PackedInt32Array(93, 91, 94), PackedInt32Array(94, 91, 95), PackedInt32Array(95, 91, 96), PackedInt32Array(97, 100, 98), PackedInt32Array(98, 100, 99), PackedInt32Array(102, 101, 103), PackedInt32Array(103, 101, 104), PackedInt32Array(106, 105, 107), PackedInt32Array(107, 105, 108), PackedInt32Array(110, 109, 111), PackedInt32Array(111, 109, 112), PackedInt32Array(114, 113, 115), PackedInt32Array(115, 113, 116), PackedInt32Array(118, 117, 119), PackedInt32Array(119, 117, 120), PackedInt32Array(122, 121, 123), PackedInt32Array(123, 121, 124), PackedInt32Array(126, 125, 127)]
geometry_parsed_geometry_type = 2
agent_height = 2.2
agent_radius = 0.6
edge_max_length = 2.0
filter_low_hanging_obstacles = true
filter_ledge_spans = true
filter_walkable_low_height_spans = true

[node name="Main" type="Node3D"]
script = ExtResource("1_cx8ll")

[node name="EnemyFormationTimer" type="Timer" parent="."]

[node name="EnemyPathfindingTimer" type="Timer" parent="."]
wait_time = 0.5
autostart = true

[node name="MainEnemySwitchTimer" type="Timer" parent="."]

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.671615, 0.599208, 0.435756, -0.740899, 0.542107, 0.396469, 0.0013413, -0.589126, 0.80804, 0, 12.4759, 0)
light_color = Color(1, 0.180392, 0.556863, 1)
light_energy = 5.0
light_indirect_energy = 10.0
light_volumetric_fog_energy = 5.0
light_angular_distance = 0.5
shadow_enabled = true
shadow_bias = 0.5
shadow_normal_bias = 5.0
shadow_opacity = 0.9
script = ExtResource("2_xe4gy")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_p801p")
script = ExtResource("2_7q2bx")

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
transform = Transform3D(5, 0, 0, 0, 5, 0, 0, 0, 5, 0, -164.091, -112.141)
navigation_mesh = SubResource("NavigationMesh_7y7p8")

[node name="mental-asylum" parent="NavigationRegion3D" instance=ExtResource("4_b3svt")]
transform = Transform3D(0.5, 0, 0, 0, 0.5, 0, 0, 0, 0.5, 0, 25.5872, 21.1563)

[node name="monkey" parent="." instance=ExtResource("4_y0b6v")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.85626, -30.9978, -7.17089)

[node name="Player" parent="." instance=ExtResource("2_d6f1p")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -33.9563, 20.0543)

[node name="UI" type="CanvasLayer" parent="."]

[node name="TextureProgressBar" type="TextureProgressBar" parent="UI" node_paths=PackedStringArray("player")]
offset_left = 37.0
offset_top = 31.0
offset_right = 1037.0
offset_bottom = 331.0
scale = Vector2(0.21, 0.21)
texture_under = ExtResource("5_lrdkv")
texture_progress = ExtResource("6_dnqkv")
script = ExtResource("5_fvphu")
player = NodePath("../../Player")

[node name="PauseMenu" type="CanvasLayer" parent="." node_paths=PackedStringArray("ui_layer")]
process_mode = 3
script = ExtResource("9_5iedf")
ui_layer = NodePath("../UI")

[node name="PauseButtonsContainer" type="VBoxContainer" parent="PauseMenu"]
visible = false
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -46.0
offset_top = -33.0
offset_right = 46.0
offset_bottom = 33.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_constants/separation = 50

[node name="ContinueButton" type="Button" parent="PauseMenu/PauseButtonsContainer"]
layout_mode = 2
size_flags_horizontal = 4
size_flags_vertical = 2
focus_neighbor_top = NodePath("../QuitGameButton")
theme_override_font_sizes/font_size = 48
text = "Continue"
script = ExtResource("10_uq3l4")

[node name="QuitGameButton" type="Button" parent="PauseMenu/PauseButtonsContainer"]
layout_mode = 2
size_flags_horizontal = 4
size_flags_vertical = 4
focus_neighbor_bottom = NodePath("../ContinueButton")
theme_override_font_sizes/font_size = 48
text = "Quit To Menu"
script = ExtResource("10_uq3l4")

[node name="Enemy" parent="." instance=ExtResource("5_rk86j")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -31.9143, 0)

[node name="Enemy2" parent="." instance=ExtResource("5_rk86j")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 7.32159, -31.9143, 0)

[node name="Enemy3" parent="." instance=ExtResource("5_rk86j")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -31.9143, -8.81071)

[connection signal="timeout" from="EnemyFormationTimer" to="." method="_on_enemy_formation_timer_timeout"]
[connection signal="timeout" from="EnemyPathfindingTimer" to="." method="_on_enemy_pathfinding_timer_timeout"]
[connection signal="timeout" from="MainEnemySwitchTimer" to="." method="_on_main_enemy_switch_timer_timeout"]
[connection signal="mouse_entered" from="PauseMenu/PauseButtonsContainer/ContinueButton" to="PauseMenu/PauseButtonsContainer/ContinueButton" method="_on_mouse_entered"]
[connection signal="pressed" from="PauseMenu/PauseButtonsContainer/ContinueButton" to="PauseMenu" method="_on_continue_button_pressed"]
[connection signal="mouse_entered" from="PauseMenu/PauseButtonsContainer/QuitGameButton" to="PauseMenu/PauseButtonsContainer/QuitGameButton" method="_on_mouse_entered"]
[connection signal="pressed" from="PauseMenu/PauseButtonsContainer/QuitGameButton" to="PauseMenu" method="_on_quit_game_button_pressed"]
